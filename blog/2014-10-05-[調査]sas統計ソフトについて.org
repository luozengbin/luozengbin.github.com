#+TITLE: [調査]SAS統計ソフトについて
#+DATE: 2014-10-05
#+SETUPFILE: ~/.emacs.d/blogs/octopress/setupfile.org
#+JEKYLL_LAYOUT: post
#+JEKYLL_CATEGORIES: misc
#+JEKYLL_TAGS: SAS R gnuplot
#+JEKYLL_COMMENTS: true
#+JEKYLL_PUBLISHED: true

ある飲み会で =JT= のプログラムマーさんと出会って、最初彼からの自己紹介で「プログラムマー
です」と聞いた時に、Java屋、Ruby屋普通のWebエンジニアだと思った。話を詳しく聞くとなん
と、「SAS」という言語しか扱っていないようです。 =SAS= という言語は初耳なので、軽く調べること
にした。

{{{more}}}

* SASとは
SASの全称はStatistical Analysis System、日本語発音は「サス」というようです。
以下はIT用語辞書からの引用です。
#+begin_example
SAS Institute社が開発・販売している、統計解析ソフトを中心とするソフトウェア製品群のブ
ランド名。また、SAS Institute社自体。

世界的に人気の高い統計解析ソフトウェアで、1960年代から主に大学や研究所で科学・工学分野
の研究に用いられてきた。近年ではビジネス向けの機能や関連製品が充実し、主要なBI(ビジネ
スインテリジェンス)ツールの一つとして企業の業務分析や意思決定支援の分野でも導入が進ん
でいる。
#+end_example
なんと1960年代、父親が生まれた時代ですね、かなり古い！
#+begin_html
<font color="red"><strong>
#+end_html
という訳で、「SAS」は言語名、会社名、ソフトウェア製品群のブランド名として使える。次に
SAS言語についてです。
#+begin_html
</strong></font>
#+end_html
* SAS言語
以下は [[http://wikiwiki.jp/cattail/?SAS%25C6%25FE%25CC%25E71][SAS入門1]] からのSAS言語についての説明内容です。

#+begin_example
ＳＡＳ言語は，非常に古いコンピュータ言語のひとつですが，
ＦＯＲＴＲＡＮ，ＣＯＢＯＬ，Ｃといった第３世代言語（高級言語）と違い，
第４世代言語（４ＧＬ）または簡易言語と呼ばれる言語の１つです．
１つの命令文の受け持つ処理が，高級言語よりたくさんの作業をこなしてくれるので，，
プログラミングする人にとって複雑な内容を簡単に書くことができるというメリットがあります．
ＳＡＳが得意とするデータ処理は，統計解析やデータマイニングといった，データ分析処理です．
データを管理したり，データシステム構築することもできますが，大量データに対する
データ分析機能は，ＳＡＳがナンバーワンといってもよいでしょう．
製薬，金融，マーケティング，通信，製造といった分野で広く使われています．
#+end_example
第４世代言語とい言われる代表的な言語は
- データベース分野のSQL
- 統計分野のR言語
- Web開発分野のRuby on Rails
があるでしょう。SASはこれらの言語の中にR言語と同じ分野ですね。 R言語は過去SI仕事でソフト
の性能測定結果の統計分析で検証したことがあるので、なんとなくイメージが付きます。ここ
でようやくSASとの接点が見つかりました。

ちなみにEmacsからRを扱う設定は [fn:1] が参考になります。

* 統計分析のイメージ
=JT= のプログラムマーさんの話から考えると、SASを使ってデータを統計分析する作業流れは
以下のようなイメージのようです。(自信がない、間違っているかも知れない)

[[file:img/2014-10-05-sas-chat1.png]]
# [img:img/2014-10-05-sas-chat1.png]

1. 市場調査手段
   - 紙媒体アンケート
   - アンケートサイト
   - SNS(Twitter,Facebookなど)より情報収集
2. SASより統計分析
   - 業務視点からデータモデルを設計する（SAS提供している専用モデルの流用など）
   - SASスクリプトを実装する
   - 1で収集したテキストデータを分析する
   - レポートを出力する

モデリングの部分は業務知識が要求されるところでしょうね。

「医療統計学」でamazonを検索したら、本が結構出している感じがする。
http://www.amazon.co.jp/gp/bestsellers/books/720750

医療統計に関して、またっく知識がないのですが、ここではSASプログラムサンプルコードを見
てスクリプトのイメージを掴みたいと思います。

* SASプログラムのイメージ
以下はSASプログラムの雛形です。
#+begin_example
options ...

data <DATAセット名>;
     infile '<CSVファイルのパス>';
     INPUT 変数名1 変数名2 変数名3 ......;

proc プロシジャー名 その他オプション;

run;
#+end_example

以下は、 =plot= プロシージャーを利用してテキストデータからアスキーグラフを表現するSAS
プログラムサンプルです。
#+begin_example
options nodate number pageno=1 linesize=80 pagesize=35;

data djia;
      input Year @7 HighDate date7. High @24 LowDate date7. Low;
      format highdate lowdate date7.;
      datalines;
1954  31DEC54  404.39  11JAN54  279.87
1955  30DEC55  488.40  17JAN55  388.20
...more data lines... 
1993  29DEC93 3794.33  20JAN93 3241.95
1994  31JAN94 3978.36  04APR94 3593.35
;

proc plot data=djia;
   plot high*year='*';

   title 'High Values of the Dow Jones Industrial Average';
   title2 'from 1954 to 1994';
run;
#+end_example
コードは [[http://support.sas.com/documentation/cdl/en/proc/61895/HTML/default/viewer.htm#a002473567.htm][Base SAS(R) 9.2 Procedures Guide]] から引用しています。

出力結果は以下のようなイメージになります。
#+begin_example
                High Values of the Dow Jones Industrial Average                1
                               from 1954 to 1994

                    Plot of High*Year.  Symbol used is '*'.

         High |
              |
         4000 +                                              *
              |                                             *
              |
              |                                            *
              |                                           *
         3000 +                                          *
              |                                       * *
              |
              |
              |                                        *
         2000 +                                      *
              |
              |                                     *
              |
              |                                   **
         1000 +                 ***** ***  *** ***
              |             ****     *   **   *
              |        *****
              |      **
              |
            0 +
              |
              ---+---------+---------+---------+---------+---------+--
               1950      1960      1970      1980      1990      2000

                                        Year
#+end_example

SASプログラムの文法構造がかなり =gnuplot= と似ってことが気付きました。でも [[http://www.gnuplot.info/][gnuplot]] が生
まれるのが1986年なので、後者が前者の形を引き続いた気がします。仕事でソフトの性能検証デー
タをフラフに加工する処理でよくgnuplotを使っています。 =OSS= なので無償で使える。SASで
も同じことができると思いますが、かなり高額のようです。コストパフォーマンスが悪いでしょ
うね。

* 無償で使えるの？
商用がメインなのでかなり高額です。SAS無償で使えるやつがあるけど、大学研究用途のみです。
おそらく個人勉強用でも問題内でしょう。詳細は [[http://www.slideshare.net/yuhsukek/sas-university-edition-38601663][Sas University Editionを使おう（インストール編）]]

SAS University Editionのダウンロードリンク
http://www.sas.com/en_us/software/university-edition/download-software.html

機会があれば、導入して遊んで見たいと思います。

* 日本での事例
- [[http://www.nec.co.jp/press/ja/1205/2202.html][ビッグデータ領域で、NECとSAS Institute Japanが協業]]
- [[http://www.sas.com/ja_jp/customers/jt.html][日本たばこ産業株式会社]]
- 他にも結構あります。[fn:2]

* おまけに
- Javaの接点
  - SAS クライアントアプリケーションがJavaに依存しているようです。[fn:3]
  - Hadoopと連携するプロジェクトが今年から発足しているようです。[fn:4]

- 他の統計ソフトとの比較
  詳細は [fn:5]

* 参考リンク
- [[http://www.rcommanderdeigakutoukeikaiseki.com/index.html][臨床医のためのRコマンダーによる医学統計解析マニュアル]]
- [[http://www2.ngu.ac.jp/~taniguch/stat/intro-sas.htm][ＳＡＳ統計パッケージ の使い方]]
- [[http://sas.mathlab.info/index.html][SAS統計データ解析入門]]
- [[http://wikiwiki.jp/cattail/?FrontPage][Welcome to データ分析・マイニングの世界 by SAS]]

[fn:1] [[http://sheephead.homelinux.org/2009/10/26/1673/][これからEmacsでR使う人のための設定まとめ]]
[fn:2] [[http://www.sas.com/ja_jp/customers.html][SASユーザー事例]]
[fn:3] [[http://www.sas.com/offices/asiapacific/japan/service/resources/thirdpartysupport/v93/jres.html][SAS® 9.3（TS1M0以降） でサポートするJava Runtime Environment]]
[fn:4] [[http://www.sas.com/ja_jp/news/press-releases/2014/september/2014-09-03-shionogi-imstat-for-hadoop-jp.html][SAS Institute Japan、塩野義製薬とHadoop上でビッグデータを活用した研究プロジェクトを発足]]
[fn:5] [[https://sites.google.com/site/statinfra/comparison][統計ソフトの比較]]
